---
title: "ELEFAN_GA Report"
output: pdf_document
date: "`r format(Sys.time(), '%d %B, %Y')`"
---

> Electronic LEngth Frequency ANalysis with genetic algorithm used for estimating growth parameters

## Raw LFQ data

Length frequency data visualised in terms of catches.

```{r echo=FALSE}
plot(elefan_ga$results$plot1, Fname = "catch", date.axis = "modern")
```

## Recontructed LFQ data

Restructured data with bin sizes and the number of bins over which the moving average is calculated as defined in the optional parameters.

```{r echo=FALSE}
plot(elefan_ga$results$plot2, Fname = "rcounts", date.axis = "modern")
```

## Results of the computation

Graphical fit of growth curves plotted through the length frequency data.

```{r echo=FALSE}
plot(elefan_ga$results$data)
```

## Thompson and Bell model with changes in F

Results of the Thompson and Bell model: Curves of yield and biomass per recruit. The black dot represents yield and biomass under current fishing pressure. The yellow and red dashed lines represent fishing mortality for maximum sustainable yield (Fmsy) and fishing mortality to fish the stock at 50% of the virgin biomass (F0.5).

```{r echo=FALSE}
plot(elefan_ga$results$plot3, mark = TRUE)
mtext("(a)", side = 3, at = -1, line = 0.6)
```

## Thompson and Bell model with changes in F and Lc

Exploration of impact of different exploitation rates and Lc values on the relative yield per recruit.

```{r echo=FALSE}
plot(elefan_ga$results$plot4, type = "Isopleth", xaxis1 = "FM", mark = TRUE, contour = 6)
mtext("(b)", side = 3, at = -0.1, line = 0.6)
```


******


**Highest value of fitness function:** `r elefan_ga$results$data$Rn_max`

**Length infinity ( $L_\infty$ in cm ):** `r elefan_ga$results$data$par$Linf`

**Curving coefficient (K):** `r elefan_ga$results$data$par$K`

**Time point anchoring growth curves in year-length coordinate system, corresponds to peak spawning month (t_anchor):** `r elefan_ga$results$data$par$t_anchor`

**Amplitude of growth oscillation (NOTE: only if 'Seasonalized' is checked; C):** `r elefan_ga$results$data$par$C`

**Winter point of oscillation ($t_w$)**

**Summer point of oscillation (NOTE: only if 'Seasonalized' is checked; $ts$=$t_w$-0.5):** `r ifelse(is.na(elefan_ga$results$data$par$ts), NA, round(elefan_ga$results$data$par$ts, 2))`

**Growth performance index defined as phiL = log10(K) + 2 * log10(Linf):** `r elefan_ga$results$data$par$phiL`

**Biological reference levels:**
```{r echo=FALSE, results='asis'}
df1 <- as.data.frame(elefan_ga$results$plot3$df_Es)
knitr::kable(df1, digits = 2, align=rep('c', 5))
```

**Current yield and biomass levels:**
```{r echo=FALSE, results='asis'}
CURR_GA<-elefan_ga$results$plot3$currents
CURR_GA<-CURR_GA[,-7]
names(CURR_GA)<-c("Length-1st-capture(Lc)", "Age-1st-capture(tc)", "Effort","Fishing mortality", "Catch", "Yield", "Biomass")
df2 <- as.data.frame(CURR_GA)
knitr::kable(df2, digits = 2, align=rep('c', 5))
```

******
## Input parameters  
Input File: `r input$fileGa$name`  
Seasonalized: `r if(!is.null(input$ELEFAN_GA_seasonalised)){if(input$ELEFAN_GA_seasonalised){"TRUE"}else{"FALSE"}}else{"FALSE"}`  
  
**Low Par**  
Linf: `r input$ELEFAN_GA_lowPar_Linf`  
K: `r input$ELEFAN_GA_lowPar_K`  
t anchor: `r input$ELEFAN_GA_lowPar_t_anchor`  
C: `r input$ELEFAN_GA_lowPar_C`  
TS: `r input$ELEFAN_GA_lowPar_ts`  
  
**Up Par**  
Linf: `r input$ELEFAN_GA_upPar_Linf`  
K: `r input$ELEFAN_GA_upPar_K`  
t anchor: `r input$ELEFAN_GA_upPar_t_anchor`  
C: `r input$ELEFAN_GA_upPar_C`  
TS: `r input$ELEFAN_GA_upPar_ts`
  
**Optional Parameters**  
Population size: `r input$ELEFAN_GA_popSize`  
Maxiter: `r input$ELEFAN_GA_maxiter`  
Run: `r input$ELEFAN_GA_run`  
P Mutation: `r input$ELEFAN_GA_pmutation`  
P Crossover: `r input$ELEFAN_GA_pcrossover`  
Elitism: `r input$ELEFAN_GA_elitism`  
MA: `r input$ELEFAN_GA_MA`  
sqrt: `r if(!is.null(input$ELEFAN_GA_addl.sqrt)){if(input$ELEFAN_GA_addl.sqrt){"TRUE"}else{"FALSE"}}else{"FALSE"}`  
Plus group: `r input$ELEFAN_GA_PLUS_GROUP`  

******
## Dataset
Synthetic length-frequency data as generated by the function lfqGen from the fishdynr package (Taylor 2016). Can be used by ELEFAN, ELEFAN_SA, or ELEFAN_GA. The data is generated with the following von Bertalanffy growth parameters:

* K = 0.2 +/- 0.1 (CV)

* Linf = 123 +/- 0.05 (CV)

* C = 0.3

* ts = 0

* t_anchor between 0.16 and 0.34 (Time when yearly recruitment pulse occurs; e.g. 0 = Jan 1, 0.25 = Apr 1, 0.5 = Jul 1, 0.75 = Oct 1; repro_wt = c(0, 0, 0.2, 1, 0.6, 0, 0, 0, 0, 0, 0, 0))